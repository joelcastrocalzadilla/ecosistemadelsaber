<!DOCTYPE html>
<html lang="es">
<head>
<meta charset="UTF-8">
<title>Practicando s√≠labas con emojis</title>
<style>
  body { font-family: sans-serif; text-align: center; background: #e3f2fd; }
  input, button { font-size: 1.5em; margin: 10px; padding: 10px; border-radius: 8px; }
  #silabaMostrada { font-size: 5em; margin-top: 20px; }
  #imagenes { font-size: 3em; margin-top: 10px; }
  #saludo { font-size: 1.2em; margin-top: 10px; color: #333; }
</style>
</head>
<body>
  <h1>Practicando s√≠labas con emojis</h1>
  <input id="nombre" placeholder="Tu nombre">
  <button onclick="iniciar()">Comenzar</button>
  <button onclick="repetirSilaba()">üîÅ Repetir</button>
  <div id="saludo"></div>
  <input id="entrada" maxlength="3" placeholder="pa" oninput="decirSilaba()">
  <div id="silabaMostrada"></div>
  <div id="imagenes"></div>

<script>
let voces = [];
let nombreNi√±o = "ni√±o";
let timerInactividad;
let ultimaSilaba = "";

// ‚úÖ Diccionario de s√≠labas con la letra P
const ejemplos = {
  "pa":[["pato","ü¶Ü"],["papa","ü•î"],["paleta","üç≠"]],
  "pe":[["pera","üçê"],["pelota","‚öΩ"],["perro","üê∂"]],
  "pi":[["pino","üå≤"],["piedra","ü™®"],["pintura","üé®"]],
  "po":[["pollo","üêî"],["polo","üç≠"],["port√≥n","üö™"]],
  "pu":[["pulpo","üêô"],["puma","üêÜ"],["pupusa","ü•ü"]]
};

function cargarVoces() {
  voces = speechSynthesis.getVoices();
  if (voces.length === 0) setTimeout(cargarVoces, 500);
}
speechSynthesis.onvoiceschanged = cargarVoces;
cargarVoces();

function hablar(texto){
  if (voces.length === 0) voces = speechSynthesis.getVoices();
  let utter = new SpeechSynthesisUtterance(texto);
  utter.lang = "es-ES";
  utter.rate = 0.8;
  let voz = voces.find(v => v.lang.startsWith("es"));
  if (voz) utter.voice = voz;
  speechSynthesis.cancel();
  speechSynthesis.speak(utter);
}

function iniciar(){
  let nombreIngresado = document.getElementById("nombre").value.trim();
  if(nombreIngresado) nombreNi√±o = nombreIngresado;
  let mensaje = `Hola ${nombreNi√±o}, escribe una s√≠laba para comenzar.`;
  document.getElementById("saludo").textContent = mensaje;
  hablar(mensaje);
  reiniciarTimer();
}

function reiniciarTimer(){
  clearTimeout(timerInactividad);
  timerInactividad = setTimeout(()=>{
    let mensaje = `¬°Ey ${nombreNi√±o}! ¬øQu√© pasa? Sigamos practicando, cambia la s√≠laba...`;
    document.getElementById("saludo").textContent = mensaje;
    hablar(mensaje);
  }, 20000);
}

function decirSilaba(){
  reiniciarTimer();
  let silaba = document.getElementById("entrada").value.toLowerCase();
  if(!silaba.match(/^[a-z√±]{1,3}$/i)) return;
  ultimaSilaba = silaba;
  document.getElementById("silabaMostrada").textContent = silaba.toUpperCase();

  let lista = ejemplos[silaba] || [];
  if(lista.length === 0){
    hablar(`Lo siento ${nombreNi√±o}, no tengo ejemplos para la s√≠laba ${silaba}. Intenta con otra.`);
    document.getElementById("imagenes").innerHTML = "";
    return;
  }

  let mensaje = `${silaba} de ${lista.map(p => p[0]).join(", ")}. Muy bien ${nombreNi√±o}.`;
  hablar(mensaje);
  document.getElementById("imagenes").innerHTML = lista.map(p => p[1]).join(" ");
}

function repetirSilaba(){
  if(!ultimaSilaba) return;

  let lista = ejemplos[ultimaSilaba] || [];
  if(lista.length === 0){
    hablar(`Lo siento ${nombreNi√±o}, no tengo ejemplos para la s√≠laba ${ultimaSilaba}.`);
    return;
  }

  let mensaje = `${ultimaSilaba} de ${lista.map(p => p[0]).join(", ")}. Muy bien ${nombreNi√±o}.`;
  hablar(mensaje);
  document.getElementById("imagenes").innerHTML = lista.map(p => p[1]).join(" ");
}
</script>
</body>
</html>
