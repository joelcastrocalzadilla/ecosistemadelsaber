<!DOCTYPE html>
<html lang="es">
<head>
  <meta charset="UTF-8">
  <title>Lanza con √°ngulo y fuerza</title>
  <style>
    :root {
      --pelota-size: 2em;
      --canasta-width: 100px;
    }
    body {
      font-family: sans-serif;
      text-align: center;
      background-color: #c8e6c9;
      margin: 0;
      padding: 0;
      overflow-x: hidden;
    }
    #campo {
      position: absolute;
      bottom: 0;
      left: 0;
      width: 100%;
      height: 40px;
      background-color: #2e7d32;
      z-index: 0;
    }
    #escena {
      position: relative;
      height: 400px;
      margin-top: 30px;
      overflow: hidden;
    }
    #nino {
      font-size: 3em;
      position: absolute;
    }
    #canasta {
      position: absolute;
      bottom: 40px;
      right: 50px;
      width: var(--canasta-width);
      height: 100px;
      border: 3px dashed #4caf50;
      border-radius: 20px;
      background-color: #a5d6a7;
      display: flex;
      flex-wrap: wrap;
      justify-content: center;
      align-content: flex-start;
      padding: 5px;
      z-index: 1;
    }
    .pelota {
      font-size: var(--pelota-size);
      position: absolute;
    }
    .pelotaAcumulada {
      font-size: 1.5em;
      margin: 3px;
    }
    #controls {
      margin-top: 20px;
    }
    #controls input {
      font-size: 1.5em;
      padding: 10px;
      width: 100px;
      text-align: center;
      margin: 10px;
    }
    #controls button {
      font-size: 1.5em;
      padding: 15px 30px;
      background-color: #ff9800;
      border: none;
      border-radius: 10px;
      color: white;
      cursor: pointer;
      margin-top: 10px;
    }
    #controls button:hover {
      background-color: #e68900;
    }
    #conteo {
      margin-top: 10px;
    }
    #aciertos {
      font-size: 2.5em;
      color: #1b5e20;
    }
    #intentos {
      font-size: 1.5em;
      color: #4e342e;
    }
    .confeti {
      position: absolute;
      top: 0;
      font-size: 2em;
      animation: caer 2s linear forwards;
    }
    @keyframes caer {
      to { top: 100%; opacity: 0; }
    }
    .mariposa {
      position: absolute;
      font-size: 2em;
      left: 50%;
      top: 100%;
      transform: translateX(-50%);
      animation: volar 4s ease-out forwards;
      z-index: 2;
    }
    @keyframes volar {
      0% { top: 100%; opacity: 1; }
      100% { top: 50%; opacity: 0; }
    }
    .mensaje {
      position: absolute;
      top: 50%;
      left: 50%;
      transform: translate(-50%, -50%);
      font-size: 1.5em;
      background: #fff8e1;
      padding: 10px 20px;
      border-radius: 10px;
      color: #4e342e;
      animation: aparecer 2s ease-out;
      z-index: 3;
    }
    @keyframes aparecer {
      0% { transform: scale(0); opacity: 0; }
      100% { transform: scale(1); opacity: 1; }
    }
    #toggleMusica {
      position: fixed;
      top: 10px;
      right: 10px;
      font-size: 1em;
      padding: 10px;
      z-index: 999;
    }
  </style>
</head>
<body>
  <h1>¬°Lanza con √°ngulo y fuerza!</h1>

  <div id="escena">
    <div id="nino">üßí</div>
    <div id="canasta"></div>
    <div id="campo"></div>
  </div>

  <div id="controls">
    √Ångulo: <input type="number" id="angulo" value="45" min="10" max="80">¬∞
    Fuerza: <input type="number" id="fuerza" value="50" min="10" max="150">
    <br>
    <button onclick="lanzarPelota()">üöÄ ¬°LANZAR!</button>
  </div>

  <div id="conteo">
    <div id="aciertos">üèÄ Aciertos: 0</div>
    <div id="intentos">üéØ Intentos: 0</div>
  </div>

  <!-- üéµ Sonidos -->
  <audio id="audiojuego" src="audiojuego.mp3" loop></audio>
  <audio id="aplausos" src="aplausos.mp3"></audio>
  <audio id="animo" src="animo.mp3"></audio>
  <audio id="triunfo" src="triunfo.mp3"></audio>

  <button id="toggleMusica">üîä M√∫sica ON/OFF</button>

<script>
  let aciertos = 0;
  let intentos = 0;

  const escena = document.getElementById("escena");
  const canasta = document.getElementById("canasta");
  const aplausos = document.getElementById("aplausos");
  const animo = document.getElementById("animo");
  const nino = document.getElementById("nino");
  const audio = document.getElementById("audiojuego");
  const botonMusica = document.getElementById("toggleMusica");

  function lanzarPelota() {
    intentos++;
    document.getElementById("intentos").innerText = `üéØ Intentos: ${intentos}`;

    const angulo = parseFloat(document.getElementById("angulo").value);
    const fuerza = parseFloat(document.getElementById("fuerza").value);

    const radianes = angulo * Math.PI / 180;
    const velocidadX = Math.cos(radianes) * fuerza;
    const velocidadY = Math.sin(radianes) * fuerza;

    const pelota = document.createElement("div");
    pelota.className = "pelota";
    pelota.innerText = "üèÄ";
    escena.appendChild(pelota);

    const lanzadorX = parseInt(nino.style.left) || 50;
    const lanzadorY = parseInt(nino.style.bottom) || 40;

    let x = lanzadorX;
    let y = lanzadorY;
    let tiempo = 0;

    const intervalo = setInterval(() => {
      tiempo += 0.1;
      x = lanzadorX + velocidadX * tiempo;
      y = lanzadorY + velocidadY * tiempo - 4.9 * tiempo * tiempo;

      pelota.style.left = `${x}px`;
      pelota.style.bottom = `${y}px`;

      if (y < 40) {
        clearInterval(intervalo);
        escena.removeChild(pelota);

        const canastaX = window.innerWidth - 100;

        if (x > canastaX - 50 && x < canastaX + 50) {
          aciertos++;
          const acumulada = document.createElement("div");
          acumulada.className = "pelotaAcumulada";
          acumulada.innerText = "üèÄ";
          canasta.appendChild(acumulada);

          document.getElementById("aciertos").innerText = `üèÄ Aciertos: ${aciertos}`;
          aplausos.play();
          animo.play();
          lanzarConfeti();

          moverLanzador();
        }
      }
    }, 30);
  }

  function lanzarConfeti() {
    for (let i = 0; i < 20; i++) {
      const confeti = document.createElement("div");
      confeti.className = "confeti";
      confeti.innerText = ["üéâ", "‚ú®", "üéä"][Math.floor(Math.random() * 3)];
      confeti.style.left = `${Math.random() * window.innerWidth}px`;
      escena.appendChild(confeti);
      setTimeout(() => escena.removeChild(confeti), 2000);
    }
  }

  function moverLanzador() {
    const margenIzquierdo = 20;
    const margenDerecho = escena.clientWidth - 200; // evita la canasta
    const nuevaX = Math.floor(Math.random() * (margenDerecho - margenIzquierdo)) + margenIzquierdo;
        const nuevaY = 40; // fijo en el suelo
    nino.style.left = `${nuevaX}px`;
    nino.style.bottom = `${nuevaY}px`;
  }

  function decir(texto) {
    const voz = new SpeechSynthesisUtterance(texto);
    voz.lang = 'es-ES';
    speechSynthesis.speak(voz);
  }

  // M√∫sica autom√°tica + bot√≥n ON/OFF
  window.addEventListener('load', () => {
    audio.play().catch(() => {
      // Si el navegador bloquea autoplay, el usuario puede activarla con el bot√≥n
    });
  });

  botonMusica.addEventListener("click", () => {
    if (audio.paused) {
      audio.play();
      decir("¬°M√∫sica activada!");
    } else {
      audio.pause();
      decir("M√∫sica apagada.");
    }
  });

  // Iniciar lanzador en posici√≥n v√°lida
  moverLanzador();
</script>
</body>
</html>
