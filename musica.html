<!DOCTYPE html>
<html lang="es">
<head>
<meta charset="UTF-8">
<title>Suma divertida con ositos, globo y piano</title>
<style>
  body { font-family: sans-serif; text-align: center; margin: 0; padding: 0; }
  .pantalla { display: none; padding: 20px; }
  #inicio { display: block; }
  .grupo { font-size: 2em; margin: 20px; min-height: 50px; }
  .contenedor { display: flex; justify-content: center; gap: 50px; }
  #globo {
    width: 100px; height: 100px;
    border-radius: 50%;
    background: red;
    margin: 20px auto;
    transition: all 0.5s ease;
    display: flex; align-items: center; justify-content: center;
    font-size: 2.5em; color: white;
  }
  .globo-con-numero {
    display: flex; flex-direction: column; align-items: center; gap: 10px;
  }
  #numeroGlobo {
    font-size: 2.5em; font-weight: bold; color: #333;
  }
  #resultado { margin-top: 20px; font-size: 1.5em; }
  .cuenta {
    font-size: 2.5em;
    line-height: 1.2;
    display: inline-block;
    text-align: right;
    margin-top: 20px;
  }
  .linea {
    border-top: 3px solid black;
    margin-top: 5px;
  }
</style>
</head>
<body id="fondo">

<!-- Pantalla inicial -->
<div id="inicio" class="pantalla">
  <h1>Bienvenido a la suma divertida</h1>
  <p>Escribe tu nombre y selecciona:</p>
  <input id="nombre" placeholder="Tu nombre">
  <select id="genero">
    <option value="azul">NiÃ±o ðŸ‘¦</option>
    <option value="rosado">NiÃ±a ðŸ‘§</option>
  </select><br><br>
  <button onclick="empezar()">Comenzar</button>
</div>

<!-- Pantalla del juego -->
<div id="juego" class="pantalla">
  <h2 id="saludo"></h2>
  <p>Escribe dos nÃºmeros para sumar:</p>
  <input id="num1" type="number"> +
  <input id="num2" type="number">
  <button onclick="iniciarSuma()">Sumar</button>

  <div class="contenedor">
    <div>
      <h3>Grupo mayor</h3>
      <div id="mayor" class="grupo"></div>
    </div>
    <div>
      <h3>Grupo menor</h3>
      <div id="menor" class="grupo"></div>
    </div>
  </div>

  <div class="globo-con-numero">
    <div id="globo">ðŸŽˆ</div>
    <div id="numeroGlobo">0</div>
  </div>

  <h2 id="resultado"></h2>
  <div id="cuentaFinal"></div>
</div>

<script src="https://cdn.jsdelivr.net/npm/canvas-confetti@1.9.3/dist/confetti.browser.min.js"></script>
<script>
// --- Dibujar ositos ---
function dibujarOsitos(cantidad){
  return "ðŸ§¸".repeat(cantidad);
}

// --- Pantalla inicial ---
function empezar(){
  const nombre = document.getElementById("nombre").value;
  const genero = document.getElementById("genero").value;
  document.getElementById("inicio").style.display="none";
  document.getElementById("juego").style.display="block";
  document.getElementById("saludo").textContent = "Hola " + nombre + ", vamos a jugar!";
  if(genero==="azul"){ document.body.style.background="#cce5ff"; }
  else { document.body.style.background="#ffd6e7"; }
}

// --- Sonidos de piano ---
function playNote(frequency, duration=0.4){
  const ctx = new (window.AudioContext || window.webkitAudioContext)();
  const osc = ctx.createOscillator();
  const gain = ctx.createGain();
  osc.type = "sine";
  osc.frequency.value = frequency;
  osc.connect(gain);
  gain.connect(ctx.destination);
  osc.start();
  gain.gain.setValueAtTime(0.2, ctx.currentTime);
  gain.gain.exponentialRampToValueAtTime(0.001, ctx.currentTime + duration);
  osc.stop(ctx.currentTime + duration);
}

// Escala sencilla (Do mayor)
const escala = [261.63, 293.66, 329.63, 349.23, 392.00, 440.00, 493.88]; 
let pasoMusical = 0;
function playStepSound(){
  playNote(escala[pasoMusical % escala.length]);
  pasoMusical++;
}
function playFinalChord(){
  playNote(261.63, 1); // C
  playNote(329.63, 1); // E
  playNote(392.00, 1); // G
}

// --- Juego principal ---
function iniciarSuma(){
  let a = parseInt(document.getElementById("num1").value);
  let b = parseInt(document.getElementById("num2").value);
  if(isNaN(a)||isNaN(b)) return;

  let mayor = Math.max(a,b);
  let menor = Math.min(a,b);

  let mayorDiv = document.getElementById("mayor");
  let menorDiv = document.getElementById("menor");
  let resultado = document.getElementById("resultado");
  let globo = document.getElementById("globo");
  let numeroGlobo = document.getElementById("numeroGlobo");
  let cuentaFinal = document.getElementById("cuentaFinal");

  mayorDiv.textContent = dibujarOsitos(mayor);
  menorDiv.textContent = dibujarOsitos(menor);
  resultado.textContent = "";
  cuentaFinal.innerHTML = "";
  globo.style.width="100px"; globo.style.height="100px";
  globo.textContent="ðŸŽˆ";
  globo.style.background="red";
  numeroGlobo.textContent = mayor;

  let pasos = menor;
  let total = mayor;
  let intervalo = setInterval(()=>{
    if(pasos>0){
      pasos--;
      menorDiv.textContent = dibujarOsitos(pasos);
      total++;
      mayorDiv.textContent = dibujarOsitos(total);

      // crecer globo
      let size = 100 + (menor-pasos)*25;
      globo.style.width=size+"px";
      globo.style.height=size+"px";

      // actualizar nÃºmero
      numeroGlobo.textContent = total;

      // sonido de piano
      playStepSound();
    } else {
      clearInterval(intervalo);
      resultado.textContent = `Resultado: ${mayor+menor} ositos`;
      // ExplosiÃ³n de confeti ðŸŽ‰
      confetti({ particleCount: 200, spread: 80, origin: { y: 0.6 } });
      globo.style.background="transparent";
      globo.textContent="ðŸ’¥";
      // acorde final
      playFinalChord();

      // Mostrar la cuenta en formato vertical
      cuentaFinal.innerHTML = `
        <div class="cuenta">
          ${a}<br>
          + ${b}<br>
          <div class="linea"></div>
          ${a+b}
        </div>
      `;
    }
  }, 1000);
}
</script>
</body>
</html>